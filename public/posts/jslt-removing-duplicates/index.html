<!doctype html>
<html lang="en">
  <head><script src="/pages/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=pages/livereload" data-no-instant defer></script>
    <script>
      (function() {
        var t = localStorage.getItem('theme');
        if (t === 'dark' || t === 'light') document.documentElement.dataset.theme = t;
      })();
    </script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="Liste - http://localhost:1313/pages/">
    <title>JSLT: removing duplicates by key | Sachin</title>
    <meta name="description" content="">
    <meta property="og:url" content="http://localhost:1313/pages/posts/jslt-removing-duplicates/">
  <meta property="og:site_name" content="Sachin">
  <meta property="og:title" content="JSLT: removing duplicates by key">
  <meta property="og:description" content="When you end up with an array that has duplicate entries by some key (e.g. id, tid), you can dedupe in JSLT by turning the array into an object keyed by that field, then turning the object’s values back into an array. Duplicate keys overwrite, so you keep one entry per key.
Pattern Object from array: { for ($array) .keyField : . }
Builds an object: key = .keyField, value = the whole element. Same key appears more than once → later value wins → unique keys.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-02-05T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-02-05T00:00:00+00:00">
    <meta property="article:tag" content="Jslt">
    <meta property="article:tag" content="Json">
    <meta property="article:tag" content="Tips">

    
  <meta itemprop="name" content="JSLT: removing duplicates by key">
  <meta itemprop="description" content="When you end up with an array that has duplicate entries by some key (e.g. id, tid), you can dedupe in JSLT by turning the array into an object keyed by that field, then turning the object’s values back into an array. Duplicate keys overwrite, so you keep one entry per key.
Pattern Object from array: { for ($array) .keyField : . }
Builds an object: key = .keyField, value = the whole element. Same key appears more than once → later value wins → unique keys.">
  <meta itemprop="datePublished" content="2025-02-05T00:00:00+00:00">
  <meta itemprop="dateModified" content="2025-02-05T00:00:00+00:00">
  <meta itemprop="wordCount" content="317">
  <meta itemprop="keywords" content="Jslt,Json,Tips">
    
    <link rel="canonical" href="http://localhost:1313/pages/posts/jslt-removing-duplicates/">
    <link rel="icon" href="http://localhost:1313/pages//assets/favicon.ico">
    <link rel="dns-prefetch" href="https://www.google-analytics.com">
    <link href="https://www.google-analytics.com" rel="preconnect" crossorigin>
    <link rel="alternate" type="application/atom+xml" title="Sachin" href="http://localhost:1313/pages//atom.xml" />
    <link rel="alternate" type="application/json" title="Sachin" href="http://localhost:1313/pages//feed.json" />
    <link rel="shortcut icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNk+A8AAQUBAScY42YAAAAASUVORK5CYII=">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Bricolage+Grotesque">
    
    
    <style>*,:after,:before{box-sizing:border-box;padding:0}body{font:1rem/1.5 bricolage grotesque,-apple-system,BlinkMacSystemFont,segoe ui,Helvetica,Arial,sans-serif;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;padding:2rem;background:#fffdfa;color:#000}.skip-link{position:absolute;top:-40px;left:0;background:#eee;z-index:100}.skip-link:focus{top:0}header{line-height:2;padding-bottom:1.5rem}.link{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-decoration:none}.time{font-variant-numeric:tabular-nums;white-space:nowrap}blockquote{border-left:5px solid #eee;padding-left:1rem;margin:0}a,a:visited{color:inherit}a:hover,a.heading-link{text-decoration:none}pre{padding:.5rem;overflow:auto;overflow-x:scroll;overflow-wrap:normal}code,pre{font-family:San Francisco Mono,Monaco,consolas,lucida console,dejavu sans mono,bitstream vera sans mono,monospace;font-size:normal;font-size:small;background:#eee}code{margin:.1rem;border:none}ul{list-style-type:square}ul,ol{padding-left:1.2rem}.list{line-height:2;list-style-type:none;padding-left:0}.list li{padding-bottom:.1rem}.meta{color:#777}.content{max-width:70ch;margin:0 auto}header{line-height:2;display:flex;justify-content:space-between;padding-bottom:1rem}header a{text-decoration:none}header ul{list-style-type:none;padding:0}header li,header a{display:inline}h2.post{padding-top:.5rem}header ul a:first-child{padding-left:1rem}.nav{height:1px;background:#000;content:'';max-width:10%}.list li{display:flex;align-items:baseline}.list li time{flex:initial}.hr-list{margin-top:0;margin-bottom:0;margin-right:.5rem;margin-left:.5rem;height:1px;border:0;border-bottom:1px dotted #ccc;flex:1 0 1rem}.m,hr{border:0;margin:3rem 0}img{max-width:100%;height:auto}.post-date{margin:5% 0}.index-date{color:#9a9a9a}.animate-blink{animation:opacity 1s infinite;opacity:1}@keyframes opacity{0%{opacity:1}50%{opacity:.5}100%{opacity:0}}.tags{display:flex;justify-content:space-between}.tags ul{padding:0;margin:0}.tags li{display:inline}.avatar{height:120px;width:120px;position:relative;margin:-10px 0 0 15px;float:right;border-radius:50%}table{width:100%;border-collapse:collapse}th,td{border:1px solid #ddd;text-align:left;padding:8px}th{background-color:#f2f2f2} :root{--bg:#fffdfa;--text:#000;--text-muted:#777;--border:#ccc;--code-bg:#eee;--hr:#000;--table-border:#dddddd;--th-bg:#f2f2f2;--skip-link-bg:#eee;--blockquote-border:#eee}@media(prefers-color-scheme:dark){:root:not([data-theme=light]){--bg:#1a1a1a;--text:#e4e4e4;--text-muted:#9a9a9a;--border:#444;--code-bg:#2d2d2d;--hr:#e4e4e4;--table-border:#444;--th-bg:#2d2d2d;--skip-link-bg:#2d2d2d;--blockquote-border:#555}}[data-theme=dark]{--bg:#1a1a1a;--text:#e4e4e4;--text-muted:#9a9a9a;--border:#444;--code-bg:#2d2d2d;--hr:#e4e4e4;--table-border:#444;--th-bg:#2d2d2d;--skip-link-bg:#2d2d2d;--blockquote-border:#555}[data-theme=light]{--bg:#fffdfa;--text:#000;--text-muted:#777;--border:#ccc;--code-bg:#eee;--hr:#000;--table-border:#dddddd;--th-bg:#f2f2f2;--skip-link-bg:#eee;--blockquote-border:#eee}body{background:var(--bg)!important;color:var(--text)!important}.skip-link{background:var(--skip-link-bg)!important}header a,header a:visited,a,a:visited{color:inherit}.hero-name{font-family:inherit;font-weight:700;font-size:1.5rem;color:var(--text);line-height:1;display:inline-block;vertical-align:middle}.hero-cursor{display:inline-block;width:.18em;height:.9em;margin-left:.32em;background-color:#666;border-radius:.15em;vertical-align:middle;animation:hero-blink 1s steps(1,end)infinite}@keyframes hero-blink{50%{opacity:0}}@media(prefers-reduced-motion:reduce){.hero-cursor{animation:none}}[data-theme=dark] .hero-cursor,:root:not([data-theme=light]) .hero-cursor{background-color:#9a9a9a}.nav{background:var(--hr)!important}.header-divider{border:0;border-bottom:1px solid var(--border);margin:.75rem 0 1rem}.latest-posts-heading{margin-top:2rem;font-size:1.15em}.hr-list{border:0;border-bottom:1px solid var(--border);border-bottom-color:var(--border)!important}.meta,.index-date{color:var(--text-muted)!important}blockquote{border-left-color:var(--blockquote-border)!important}code,pre{background:var(--code-bg)!important;color:var(--text)!important}.content pre,.content pre code,.content pre span,.content .highlight pre,.content .highlight pre code,.content .highlight pre span{color:var(--text)!important;background:0 0!important}.content pre,.content .highlight pre{background:var(--code-bg)!important}th,td{border-color:var(--table-border)!important}th{background-color:var(--th-bg)!important}.theme-toggle{background:0 0;border:none;cursor:pointer;font:inherit;color:inherit;padding:0;margin-left:.5rem;opacity:.8;font-size:.9em}.theme-toggle:hover{opacity:1}.theme-toggle:focus{outline:1px dotted currentColor;outline-offset:2px}.post-list .post-link{cursor:pointer;text-decoration:underline;text-underline-offset:.15em;text-decoration-color:var(--border);transition:text-decoration-color .15s ease}.post-list .post-link:hover{text-decoration-color:var(--text)}.post-list-item{margin-bottom:.5rem}ul.post-list .post-list-item{padding:.25rem 0}ul.post-list .post-list-item:hover .post-link{text-decoration-color:var(--text)}.content pre{position:relative;padding-top:2.25rem}.copy-code-btn{position:absolute;top:.35rem;right:.35rem;font-size:.7rem;padding:.25rem .5rem;border:1px solid var(--border);background:var(--bg);color:var(--text);cursor:pointer;border-radius:2px;opacity:.85;font-family:inherit;line-height:1.2}.copy-code-btn:hover{opacity:1}.copy-code-btn:focus{outline:1px dotted currentColor;outline-offset:2px}.copy-code-btn.copied{opacity:1}.tag-filter{display:flex;flex-wrap:wrap;gap:.4rem;margin-top:1rem;margin-bottom:1.25rem;align-items:center}.tag-filter-btn{font:inherit;font-size:.85rem;padding:.25rem .75rem;border:1px solid var(--border);background:var(--bg);color:var(--text);cursor:pointer;border-radius:9999px;opacity:.85}.tag-filter-btn:hover{opacity:1}.tag-filter-btn.active{font-weight:600;border-color:var(--text);opacity:1}.tag-filter-btn:focus{outline:1px dotted currentColor;outline-offset:2px}</style>
  
    
  
  
  <script type="application/ld+json">
  {
      "@context": "http://schema.org",
      "@type": "BlogPosting",
      "articleSection": "posts",
      "name": "JSLT: removing duplicates by key",
      "headline": "JSLT: removing duplicates by key",
      "alternativeHeadline": "",
      "description": "\u003cp\u003eWhen you end up with an array that has duplicate entries by some key (e.g. \u003ccode\u003eid\u003c\/code\u003e, \u003ccode\u003etid\u003c\/code\u003e), you can dedupe in JSLT by turning the array into an \u003cstrong\u003eobject keyed by that field\u003c\/strong\u003e, then turning the object’s values back into an array. Duplicate keys overwrite, so you keep one entry per key.\u003c\/p\u003e\n\u003chr\u003e\n\u003ch3 id=\u0022pattern\u0022\u003ePattern\u003c\/h3\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eObject from array:\u003c\/strong\u003e \u003ccode\u003e{ for ($array) .keyField : . }\u003c\/code\u003e\u003cbr\u003e\nBuilds an object: key = \u003ccode\u003e.keyField\u003c\/code\u003e, value = the whole element. Same key appears more than once → later value wins → unique keys.\u003c\/p\u003e",
      "inLanguage": "en-us",
      "isFamilyFriendly": "true",
      "mainEntityOfPage": {
          "@type": "WebPage",
          "@id": "http:\/\/localhost:1313\/pages\/posts\/jslt-removing-duplicates\/"
      },
      "author" : {
          "@type": "Person",
          "name": ""
      },
      "creator" : {
          "@type": "Person",
          "name": ""
      },
      "accountablePerson" : {
          "@type": "Person",
          "name": ""
      },
      "copyrightHolder" : "Sachin",
      "copyrightYear" : "2025",
      "dateCreated": "2025-02-05T00:00:00.00Z",
      "datePublished": "2025-02-05T00:00:00.00Z",
      "dateModified": "2025-02-05T00:00:00.00Z",
      "publisher":{
          "@type":"Organization",
          "name": "Sachin",
          "url": "http://localhost:1313/pages/",
          "logo": {
              "@type": "ImageObject",
              "url": "http:\/\/localhost:1313\/pages\/",
              "width":"32",
              "height":"32"
          }
      },
      "image": "http://localhost:1313/pages/",
      "url" : "http:\/\/localhost:1313\/pages\/posts\/jslt-removing-duplicates\/",
      "wordCount" : "317",
      "genre" : [ "jslt" , "json" , "tips" ],
      "keywords" : [ "jslt" , "json" , "tips" ]
  }
  </script>
  

  <script defer>
    (function() {
      function initCopyButtons() {
        var blocks = document.querySelectorAll('.content pre');
        blocks.forEach(function(pre) {
          if (pre.querySelector('.copy-code-btn')) return;
          var btn = document.createElement('button');
          btn.type = 'button';
          btn.className = 'copy-code-btn';
          btn.textContent = 'Copy';
          btn.title = 'Copy to clipboard';
          btn.setAttribute('aria-label', 'Copy code to clipboard');
          btn.addEventListener('click', function() {
            var code = pre.querySelector('code');
            var text = (code ? code : pre).innerText || (code ? code : pre).textContent;
            navigator.clipboard.writeText(text).then(function() {
              btn.textContent = 'Copied!';
              btn.classList.add('copied');
              setTimeout(function() {
                btn.textContent = 'Copy';
                btn.classList.remove('copied');
              }, 1500);
            });
          });
          pre.appendChild(btn);
        });
      }
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initCopyButtons);
      } else {
        initCopyButtons();
      }
    })();
  </script>
  
  </head>

<body>
  <a class="skip-link" href="#main">Skip to main</a>
  <main id="main">
  <div class="content">
    <header>
  <p style="padding: 0;margin: 0;">
    <a href="http://localhost:1313/pages/">
      <span class="hero-name">Sachin</span><span class="hero-cursor" aria-hidden="true"></span>
    </a>
  </p>
  <ul style="padding: 0;margin: 0;">
    <li><a href="http://localhost:1313/pages/posts/"><span>Posts</span></a></li>
    <li><a href="http://localhost:1313/pages/about/"><span>About</span></a></li>
    <li><button type="button" class="theme-toggle" id="theme-toggle" title="Toggle dark/light">◐</button></li>
  </ul>
</header>
<script>
  (function() {
    var btn = document.getElementById('theme-toggle');
    if (!btn) return;
    function cycle() {
      var el = document.documentElement;
      var cur = el.dataset.theme || '';
      var next = (cur === 'dark') ? 'light' : 'dark';
      el.dataset.theme = next;
      localStorage.setItem('theme', next);
    }
    btn.addEventListener('click', cycle);
  })();
</script>
<hr class="header-divider">
    <section>
      <h2 class="post">JSLT: removing duplicates by key</h2>
      <p>When you end up with an array that has duplicate entries by some key (e.g. <code>id</code>, <code>tid</code>), you can dedupe in JSLT by turning the array into an <strong>object keyed by that field</strong>, then turning the object’s values back into an array. Duplicate keys overwrite, so you keep one entry per key.</p>
<hr>
<h3 id="pattern">Pattern</h3>
<ol>
<li>
<p><strong>Object from array:</strong> <code>{ for ($array) .keyField : . }</code><br>
Builds an object: key = <code>.keyField</code>, value = the whole element. Same key appears more than once → later value wins → unique keys.</p>
</li>
<li>
<p><strong>Array from object:</strong> <code>[ for ($object) .value ]</code><br>
Iterating over an object gives key/value; take <code>.value</code> and you get the original elements back, now unique by that key.</p>
</li>
</ol>
<p><strong>Together:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">let</span> <span style="color:#960050;background-color:#1e0010">withDuplicates</span> <span style="color:#960050;background-color:#1e0010">=</span> [
</span></span><span style="display:flex;"><span>  { <span style="color:#f92672">&#34;id&#34;</span>: <span style="color:#e6db74">&#34;a&#34;</span>, <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;Alpha&#34;</span> },
</span></span><span style="display:flex;"><span>  { <span style="color:#f92672">&#34;id&#34;</span>: <span style="color:#e6db74">&#34;b&#34;</span>, <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;Beta&#34;</span> },
</span></span><span style="display:flex;"><span>  { <span style="color:#f92672">&#34;id&#34;</span>: <span style="color:#e6db74">&#34;a&#34;</span>, <span style="color:#f92672">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;Alpha again&#34;</span> }
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">let</span> <span style="color:#960050;background-color:#1e0010">byId</span> <span style="color:#960050;background-color:#1e0010">=</span> { <span style="color:#960050;background-color:#1e0010">for</span> <span style="color:#960050;background-color:#1e0010">($withDuplicates)</span> <span style="color:#960050;background-color:#1e0010">.id</span> <span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#960050;background-color:#1e0010">.</span> }
</span></span><span style="display:flex;"><span>[ <span style="color:#960050;background-color:#1e0010">for</span> <span style="color:#960050;background-color:#1e0010">($byId)</span> <span style="color:#960050;background-color:#1e0010">.value</span> ]
</span></span></code></pre></div><p><strong>Result:</strong> two objects (one per distinct <code>id</code>), not three. The second <code>&quot;a&quot;</code> overwrote the first in <code>byId</code>.</p>
<hr>
<h3 id="in-a-function">In a function</h3>
<p>Same idea in a reusable helper:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">def</span> <span style="color:#960050;background-color:#1e0010">dedupe-by-key(array,</span> <span style="color:#960050;background-color:#1e0010">keyField)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">let</span> <span style="color:#960050;background-color:#1e0010">obj</span> <span style="color:#960050;background-color:#1e0010">=</span> { <span style="color:#960050;background-color:#1e0010">for</span> <span style="color:#960050;background-color:#1e0010">($array)</span> <span style="color:#960050;background-color:#1e0010">.[$keyField]</span> <span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#960050;background-color:#1e0010">.</span> }
</span></span><span style="display:flex;"><span>  [ <span style="color:#960050;background-color:#1e0010">for</span> <span style="color:#960050;background-color:#1e0010">($obj)</span> <span style="color:#960050;background-color:#1e0010">.value</span> ]
</span></span></code></pre></div><p>Use it like <code>dedupe-by-key($myArray, &quot;tid&quot;)</code> (or whatever your key field is). If JSLT doesn’t support dynamic field access, inline the key:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">def</span> <span style="color:#960050;background-color:#1e0010">dedupe-by-tid(array)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">let</span> <span style="color:#960050;background-color:#1e0010">obj</span> <span style="color:#960050;background-color:#1e0010">=</span> { <span style="color:#960050;background-color:#1e0010">for</span> <span style="color:#960050;background-color:#1e0010">($array)</span> <span style="color:#960050;background-color:#1e0010">.tid</span> <span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#960050;background-color:#1e0010">.</span> }
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">if</span> <span style="color:#960050;background-color:#1e0010">($obj)</span>
</span></span><span style="display:flex;"><span>    [ <span style="color:#960050;background-color:#1e0010">for</span> <span style="color:#960050;background-color:#1e0010">($obj)</span> <span style="color:#960050;background-color:#1e0010">.value</span> ]
</span></span><span style="display:flex;"><span>  <span style="color:#960050;background-color:#1e0010">else</span>
</span></span><span style="display:flex;"><span>    []
</span></span></code></pre></div><p>Then <code>dedupe-by-tid($sharedDevicesWithDuplicates)</code> gives you devices unique by <code>tid</code>.</p>
<hr>
<h3 id="where-this-fits">Where this fits</h3>
<p>Typical flow:</p>
<ol>
<li>Build an array that might have duplicates (e.g. from nested loops, flattened links, or merging two lists by a key).</li>
<li>Dedupe with the object trick: <code>let unique = [ for ({ for ($withDuplicates) .tid : . }) .value ]</code>.</li>
<li>Use <code>$unique</code> (or guard with <code>if ($unique) $unique else []</code> if you need an empty array when there’s nothing).</li>
</ol>
<p><strong>Try it:</strong> <a href="https://www.garshol.priv.no/jslt-demo">JSLT demo playground</a>.</p>

      
      <div class="post-date">
        <span class="g time">February 5, 2025 </span> &#8729;
         
        
        <a href="/pages/posts/#jslt">jslt</a>
        <a href="/pages/posts/#json">json</a>
        <a href="/pages/posts/#tips">tips</a>
      </div>
      
    </section>
    
    
    
  </div>
</main>
</body>
</html>
